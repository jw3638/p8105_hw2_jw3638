p8105_hw2_jw3638
================

\##Problem 1 Clean pols-month.csv data: Break up the variable mon into
integer variables year, month, and day; replace month number with month
name; create a president variable taking values gop and dem, and remove
prez_dem and prez_gop; and remove the day variable.

``` r
pols =
  read_csv("data/fivethirtyeight_datasets/pols-month.csv") |>
  separate(mon, into = c("year", "month", "day"), sep = "-", convert = TRUE) |>
  mutate(
    month = month.name[month],
    year = as.integer(year),
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem == 1 ~ "dem"
    )
  ) |>
  select(-prez_dem, -prez_gop, -day)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
#For nice display of data in knit doc:
knitr::kable(head(pols, 5))
```

| year | month    | gov_gop | sen_gop | rep_gop | gov_dem | sen_dem | rep_dem | president |
|-----:|:---------|--------:|--------:|--------:|--------:|--------:|--------:|:----------|
| 1947 | January  |      23 |      51 |     253 |      23 |      45 |     198 | dem       |
| 1947 | February |      23 |      51 |     253 |      23 |      45 |     198 | dem       |
| 1947 | March    |      23 |      51 |     253 |      23 |      45 |     198 | dem       |
| 1947 | April    |      23 |      51 |     253 |      23 |      45 |     198 | dem       |
| 1947 | May      |      23 |      51 |     253 |      23 |      45 |     198 | dem       |

Clean snp.csv data. Arrange according to year and month.

``` r
snp = 
  read_csv("data/fivethirtyeight_datasets/snp.csv") |>
  mutate(date = mdy(date)) |>
  separate(date, into = c("year", "month", "day"), sep = "-", convert = TRUE) |>
  mutate(
    month = month.name[month],
    year = as.integer(year)
  ) |>
  select(year, month, close)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
knitr::kable(head(snp, 5))
```

| year | month |   close |
|-----:|:------|--------:|
| 2015 | July  | 2079.65 |
| 2015 | June  | 2063.11 |
| 2015 | May   | 2107.39 |
| 2015 | April | 2085.51 |
| 2015 | March | 2067.89 |

Clean unemployment.csv data. Tidy it up so that it can be merged with
pols-month and csv: switch from “wide” to “long” format and label
formatting is consistent

``` r
unemployment = 
  read_csv("data/fivethirtyeight_datasets/unemployment.csv") |>
  pivot_longer(
    cols = Jan:Dec,
    names_to = "month",
    values_to = "unemployment_percentage"
  ) |>
  mutate(
    month = month.name[match(month, month.abb)],
    year = as.integer(Year)
  ) |>
  select(year, month, unemployment_percentage)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
knitr::kable(head(unemployment, 5))
```

| year | month    | unemployment_percentage |
|-----:|:---------|------------------------:|
| 1948 | January  |                     3.4 |
| 1948 | February |                     3.8 |
| 1948 | March    |                     4.0 |
| 1948 | April    |                     3.9 |
| 1948 | May      |                     3.5 |

Merging: Join the pols-month into snp, and merge unemployment into
(pols-month in snp)

``` r
merge1 <- 
  left_join(pols, snp, by = join_by(year, month))
merge2 <- 
  left_join(merge1, unemployment, by = join_by(year, month)) |>
  select(year, month, president, close, unemployment_percentage, everything())

knitr::kable(head(merge2, 10))
```

| year | month | president | close | unemployment_percentage | gov_gop | sen_gop | rep_gop | gov_dem | sen_dem | rep_dem |
|---:|:---|:---|---:|---:|---:|---:|---:|---:|---:|---:|
| 1947 | January | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | February | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | March | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | April | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | May | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | June | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | July | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | August | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | September | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |
| 1947 | October | dem | NA | NA | 23 | 51 | 253 | 23 | 45 | 198 |

Dataset 1: pols-month shows data from January to May in 1947 for gov_gop
(the number of republican governors on the associated date), rep_gop (”
representatives), gov_dem (“democratic governors), sen_dem (”democratic
senators), rep_dem (“democratic representatives), and president (both
republican and democratic presidents). Dataset 2: snp shows data from
July to March in 2015 of the the closing values of the S&P stock index
on the associated date. Dataset 3: unemployment shows data from January
to May in 1948 for unemployment_percentage. Resulting dataset (merged):
shows data from months January to October in 1947 with columns close,
unemployment_percentage, gov_gop, sen_gop, rep_gop, gov_dem, sen_dem,
rep_dem.
